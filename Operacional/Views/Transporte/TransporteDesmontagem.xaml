<UserControl x:Class="Operacional.Views.Transporte.TransporteDesmontagem"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
             xmlns:local="clr-namespace:Operacional.Views.Transporte"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">

    <Grid>
        <telerik:RadGridView x:Name="radGridView" 
                ItemsSource="{Binding Transportes}" 
                AutoGenerateColumns="False"
                ShowGroupPanel="False"
                SelectionMode="Extended"
                ClipboardCopyMode="Cells, Header"
                RowValidating="RadGridView_RowValidating">
            <!-- Configuração da Tabela Pai (Customers) -->
            <telerik:RadGridView.Columns>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding siglaserv}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding prazo_chegada}"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding volume_carga_desmontagem}" />
                <telerik:GridViewDataColumn DataMemberBinding="{Binding num_caminhoes_desmont}" />
                <telerik:GridViewDataColumn DataMemberBinding="{Binding data_inicio_desmontagem, StringFormat=\{0:dd/MM/yyyy\}}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding data_final_desmontagem, StringFormat=\{0:dd/MM/yyyy\}}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding data_libera_area_desmontagem, StringFormat=\{0:dd/MM/yyyy\}}" IsReadOnly="True"/>
                <telerik:GridViewComboBoxColumn DataMemberBinding="{Binding transportadora}" 
                                                ItemsSource="{Binding Transportadoras}"
                                                DisplayMemberPath="nometransportadora"
                                                SelectedValueMemberPath="nometransportadora" 
                                                DistinctValuesSearchMode="Contains"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding cubagem_por_produto}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding volume_carga_desmontagem}" />
                <telerik:GridViewDataColumn DataMemberBinding="{Binding cubagem_expedida}" DataFormatString="{}{0:N2}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding perc_shop}" DataFormatString="{}{0:P2}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding transporte}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding cidade}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding regiao}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding alterado_por}" IsReadOnly="True"/>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding data_altera}" IsReadOnly="True"/>
            </telerik:RadGridView.Columns>

            <!-- Definição da Hierarquia -->
            <telerik:RadGridView.ChildTableDefinitions>
                <telerik:GridViewTableDefinition>
                    <telerik:GridViewTableDefinition.Relation>
                        <telerik:PropertyRelation ParentPropertyName="Cargas" />
                    </telerik:GridViewTableDefinition.Relation>
                </telerik:GridViewTableDefinition>
            </telerik:RadGridView.ChildTableDefinitions>

            <!-- Configuração da Tabela Filha (Cargas) -->
            <telerik:RadGridView.HierarchyChildTemplate>
                <DataTemplate>
                    <telerik:RadGridView 
                        ItemsSource="{Binding Cargas}" 
                        AutoGenerateColumns="False"
                        ShowGroupPanel="False"
                        RowValidating="RadGridViewFilho_RowValidating">
                        <telerik:RadGridView.Columns>
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding caminhao}" IsReadOnly="True"/>
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding data_chegada_shopping, StringFormat=\{0:dd/MM/yyyy\}}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding data_saida_shopping, StringFormat=\{0:dd/MM/yyyy\}}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding data_chegada_cipolatti, StringFormat=\{0:dd/MM/yyyy\}}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding volume}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding confirmado}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding obs}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding descarga_caminhao}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding obs_recebimento}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding data_chegada_galpao, StringFormat=\{0:dd/MM/yyyy\}}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding hora_chegada_galpao, StringFormat=\{0:hh:mm\}}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding placa_caminhao}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding transportadora}" />
                            <telerik:GridViewDataColumn DataMemberBinding="{Binding obs_embalagem}" />
                        </telerik:RadGridView.Columns>
                    </telerik:RadGridView>
                </DataTemplate>
            </telerik:RadGridView.HierarchyChildTemplate>
        </telerik:RadGridView>
    </Grid>

</UserControl>
